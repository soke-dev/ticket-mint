"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8048],{8048:function(e,n,t){t.r(n),t.d(n,{default:function(){return eC}});var o=t(3827),i=t(62177),r=t(64090),s=t(71548),a=t(83286);function l(e){let n=e.toToken.chainId===e.onRampToken.token.chainId,t=(0,a.Kn)(e.toToken.tokenAddress)===(0,a.Kn)(e.onRampToken.token.tokenAddress);return!(n&&t)}var d=t(63621),c=t(45890),u=t(72568),x=t(51102),h=t(17440),m=t(73667),y=t(61863),p=t(23565),f=t(43051);async function j(e){try{let n=(0,p.NX)(e.client),t=await n((0,f.EW)(),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({toAddress:e.toAddress,fromCurrencySymbol:e.fromCurrencySymbol,toChainId:e.toChainId.toString(),toTokenAddress:e.toTokenAddress,fromAmount:e.fromAmount,toAmount:e.toAmount,maxSlippageBPS:e.maxSlippageBPS,isTestMode:e.isTestMode,purchaseData:e.purchaseData,fromAddress:e.fromAddress})});if(!t.ok){let e=await t.json();if(e&&"error"in e)throw e;throw Error("HTTP error! status: ".concat(t.status))}return(await t.json()).result}catch(e){throw console.error("Fetch error:",e),e}}var g=t(14297),T=t(27121),b=t(48762),v=t(52731),C=t(94071),k=t(94234),w=t(82161),S=t(972),B=t(53326),A=t(96088),L=t(39724),E=t(31137),F=t(3702),W=t(32788),z=t(49580),D=t(93336),R=t(326),P=t(72433),I=t(93610),M=t(68982);function N(e){let{estimatedSeconds:n,quoteIsLoading:t}=e;return(0,o.jsxs)(E.Container,{bg:"tertiaryBg",flex:"row",borderColor:"borderColor",style:{borderRadius:u.q0.md,borderTopLeftRadius:0,borderTopRightRadius:0,justifyContent:"space-between",alignItems:"center",borderWidth:"1px",borderStyle:"solid"},children:[(0,o.jsxs)(E.Container,{flex:"row",center:"y",gap:"xxs",color:"accentText",p:"sm",children:[(0,o.jsx)(i.T39,{width:u.EA.sm,height:u.EA.sm}),t?(0,o.jsx)(w.Skeleton,{height:u.JB.xs,width:"50px",color:"borderColor"}):(0,o.jsx)(W.Text,{size:"xs",color:"secondaryText",children:void 0!==n?"~".concat((0,M.Z)(n)):"--"})]}),(0,o.jsxs)(F.Button,{variant:"ghost",onClick:e.onViewFees,gap:"xs",children:[(0,o.jsx)(E.Container,{color:"accentText",flex:"row",center:"both",children:(0,o.jsx)(q,{size:u.EA.sm})}),(0,o.jsx)(W.Text,{size:"xs",color:"secondaryText",children:"View Fees"})]})]})}let q=e=>(0,o.jsxs)("svg",{width:e.size,height:e.size,viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[(0,o.jsx)("path",{d:"M9.5 1.5H2.5C1.94772 1.5 1.5 1.94772 1.5 2.5V9.5C1.5 10.0523 1.94772 10.5 2.5 10.5H9.5C10.0523 10.5 10.5 10.0523 10.5 9.5V2.5C10.5 1.94772 10.0523 1.5 9.5 1.5Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),(0,o.jsx)("path",{d:"M4.5 7.5L7.5 4.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})]});var O=t(58385),_=t(92432);function V(e){return(0,o.jsxs)(E.Container,{bg:"tertiaryBg",borderColor:"borderColor",flex:"row",style:{borderRadius:u.q0.md,borderBottomRightRadius:0,borderBottomLeftRadius:0,borderWidth:"1px",borderStyle:"solid",borderBottom:"none",flexWrap:"nowrap",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsxs)(U,{variant:"ghost",onClick:e.onSelectCurrency,style:{minHeight:"64px",justifyContent:"flex-start",minWidth:"50%"},gap:"sm",children:[(0,o.jsx)(e.currency.icon,{size:u.EA.md}),(0,o.jsxs)(E.Container,{flex:"row",center:"y",gap:"xxs",color:"secondaryText",children:[(0,o.jsx)(W.Text,{color:"primaryText",children:e.currency.shorthand}),(0,o.jsx)(i.v4q,{width:u.EA.sm,height:u.EA.sm})]})]}),(0,o.jsx)("div",{style:{flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",alignItems:"flex-end",gap:u.W0.xxs,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",justifyContent:"center",paddingRight:u.W0.sm},children:e.isLoading?(0,o.jsx)(w.Skeleton,{width:"100px",height:u.JB.lg}):(0,o.jsx)(W.Text,{size:"lg",color:e.value?"primaryText":"secondaryText",children:e.value?"".concat((0,d.u)(Number(e.value),4)):"--"})})]})}let U=(0,_.Z)(F.Button)(()=>({"&[disabled]:hover":{borderColor:"transparent"}}));var H=t(4966),K=t(28101);function J(e){return(0,o.jsxs)(E.Container,{children:[(0,o.jsx)(E.Container,{p:"lg",children:(0,o.jsx)(E.ModalHeader,{title:"Pay with",onBack:e.onBack})}),(0,o.jsx)(E.Line,{}),(0,o.jsx)(S.L,{y:"lg"}),(0,o.jsx)(E.Container,{flex:"column",gap:"xs",px:"lg",children:K.QT.map(n=>(0,o.jsxs)(Q,{fullWidth:!0,variant:"secondary",onClick:()=>e.onSelect(n),gap:"sm",children:[(0,o.jsx)(n.icon,{size:u.EA.lg}),(0,o.jsxs)(E.Container,{flex:"column",gap:"xxs",children:[(0,o.jsx)(W.Text,{color:"primaryText",children:n.shorthand}),(0,o.jsx)(W.Text,{size:"sm",children:n.name})]})]},n.shorthand))}),(0,o.jsx)(S.L,{y:"lg"})]})}let Q=(0,_.Z)(F.Button)(()=>{let e=(0,H.useCustomTheme)();return{background:e.colors.tertiaryBg,justifyContent:"flex-start",gap:u.W0.sm,padding:u.W0.sm,"&:hover":{background:e.colors.secondaryButtonBg,transform:"scale(1.01)"},transition:"background 200ms ease, transform 150ms ease"}});function Y(e,n){let t=(window.innerHeight-750)/2,o=(window.innerWidth-500)/2;return window.open("".concat(e,"&theme=").concat(n),"thirdweb Pay","width=".concat(500,", height=").concat(750,", top=").concat(t,", left=").concat(o))}var G=t(79048),Z=t(47082),$=t(15497),X=t(24134),ee=t(10194),en=t(35149),et=t(37697),eo=t(94322),ei=t(11832);function er(e){var n,t,i,s;let a=(0,Z.useQueryClient)(),{openedWindow:l}=e,d=(0,X.s)({intentId:e.intentId,client:e.client}),c="loading";(null===(n=d.data)||void 0===n?void 0:n.status)==="ON_RAMP_TRANSFER_FAILED"||(null===(t=d.data)||void 0===t?void 0:t.status)==="PAYMENT_FAILED"?c="failed":(null===(i=d.data)||void 0===i?void 0:i.status)==="CRYPTO_SWAP_FALLBACK"?c="partialSuccess":(null===(s=d.data)||void 0===s?void 0:s.status)==="ON_RAMP_TRANSFER_COMPLETED"&&(c="completed"),(0,r.useEffect)(()=>{var e,n;l&&d.data&&((null===(e=d.data)||void 0===e?void 0:e.status)==="CRYPTO_SWAP_REQUIRED"||(null===(n=d.data)||void 0===n?void 0:n.status)==="ON_RAMP_TRANSFER_COMPLETED")&&l.close()},[d.data,l]);let u=(0,r.useRef)(!1);return(0,r.useEffect)(()=>{var e;u.current||(null===(e=d.data)||void 0===e?void 0:e.status)!=="ON_RAMP_TRANSFER_COMPLETED"||(u.current=!0,(0,ee.K)(a))},[d.data,a]),(0,r.useEffect)(()=>{var n;(null===(n=d.data)||void 0===n?void 0:n.status)==="CRYPTO_SWAP_REQUIRED"&&e.onShowSwapFlow(d.data)},[d.data,e.onShowSwapFlow]),(0,o.jsxs)(E.Container,{p:"lg",children:[(0,o.jsx)(E.ModalHeader,{title:"Buy",onBack:e.onBack}),e.hasTwoSteps&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(S.L,{y:"lg"}),(0,o.jsx)(en.E,{steps:2,currentStep:1}),(0,o.jsx)(S.L,{y:"sm"}),(0,o.jsxs)(W.Text,{size:"xs",children:["Step 1 of 2 - Buying ",e.quote.onRampToken.token.symbol," with"," ",e.quote.fromCurrencyWithFees.currencySymbol]})]}),(0,o.jsx)(es,{uiStatus:c,onDone:e.onDone,fiatStatus:d.data,client:e.client,isBuyForTx:e.isBuyForTx,quote:e.quote,isEmbed:e.isEmbed})]})}function es(e){let{uiStatus:n}=e,t=e.fiatStatus?(0,eo.B)(e.fiatStatus):void 0,r=e.fiatStatus&&"NOT_FOUND"!==e.fiatStatus.status?e.fiatStatus:void 0,s=e.quote.onRampToken,a=(0,o.jsx)(ei.s,{client:e.client,token:(null==r?void 0:r.source)?{chainId:r.source.token.chainId,address:r.source.token.tokenAddress,symbol:r.source.token.symbol||"",amount:r.source.amount}:{chainId:s.token.chainId,address:s.token.tokenAddress,symbol:s.token.symbol,amount:s.amount},fiat:{amount:e.quote.fromCurrencyWithFees.amount,currencySymbol:e.quote.fromCurrencyWithFees.currencySymbol},statusMeta:(null==r?void 0:r.source)&&t?{color:null==t?void 0:t.color,text:null==t?void 0:t.status,txHash:r.source.transactionHash}:void 0});return(0,o.jsxs)(E.Container,{children:[(0,o.jsx)(S.L,{y:"xl"}),"loading"===n&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(S.L,{y:"md"}),(0,o.jsx)(E.Container,{flex:"row",center:"x",children:(0,o.jsx)(B.Spinner,{size:"3xl",color:"accentText"})}),(0,o.jsx)(S.L,{y:"md"}),(0,o.jsx)(W.Text,{color:"primaryText",size:"lg",center:!0,children:"Buy Pending"}),(0,o.jsx)(S.L,{y:"sm"}),!(0,$.tq)()&&(0,o.jsx)(W.Text,{center:!0,children:"Complete the purchase in popup"}),(0,o.jsx)(S.L,{y:"xxl"}),a]}),"failed"===n&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(S.L,{y:"md"}),(0,o.jsx)(E.Container,{flex:"row",center:"x",children:(0,o.jsx)(et.E,{size:u.EA["3xl"]})}),(0,o.jsx)(S.L,{y:"lg"}),(0,o.jsx)(W.Text,{color:"primaryText",size:"lg",center:!0,children:"Transaction Failed"}),(0,o.jsx)(S.L,{y:"xxl"}),a]}),"completed"===n&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(S.L,{y:"md"}),(0,o.jsx)(E.Container,{flex:"row",center:"x",color:"success",children:(0,o.jsx)(i.NhS,{width:u.EA["3xl"],height:u.EA["3xl"]})}),(0,o.jsx)(S.L,{y:"md"}),(0,o.jsx)(W.Text,{color:"primaryText",size:"lg",center:!0,children:"Buy Complete"}),e.fiatStatus&&"NOT_FOUND"!==e.fiatStatus.status&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(S.L,{y:"xxl"}),a,(0,o.jsx)(S.L,{y:"sm"})]}),!e.isEmbed&&(0,o.jsx)(F.Button,{variant:"accent",fullWidth:!0,onClick:e.onDone,children:e.isBuyForTx?"Continue Transaction":"Done"})]})]})}var ea=t(4718),el=t(66766);function ed(e){let n=l(e.quote),[t,i]=(0,r.useState)(n?{id:"step-1"}:{id:"onramp-status"}),[s,a]=(0,r.useState)(e.openedWindow);return"step-1"===t.id?(0,o.jsx)(ea.a,{client:e.client,onBack:e.onBack,partialQuote:(0,ea.R)(e.quote),step:1,onContinue:()=>{let n=Y(e.quote.onRampLink,e.theme);(0,G.h)({type:"fiat",intentId:e.quote.intentId}),a(n),i({id:"onramp-status"})}}):"onramp-status"===t.id?(0,o.jsx)(er,{client:e.client,intentId:e.quote.intentId,onBack:e.onBack,onViewPendingTx:e.onViewPendingTx,hasTwoSteps:n,openedWindow:s,quote:e.quote,onDone:e.onDone,onShowSwapFlow:e=>{i({id:"postonramp-swap",data:e})},isBuyForTx:e.isBuyForTx,isEmbed:e.isEmbed}):"postonramp-swap"===t.id?(0,o.jsx)(el.S,{status:t.data,quote:(0,ea.R)(e.quote),client:e.client,onBack:e.onBack,onViewPendingTx:e.onViewPendingTx,onDone:e.onDone,onSwapFlowStarted:()=>{},isBuyForTx:e.isBuyForTx,isEmbed:e.isEmbed}):null}var ec=t(72751),eu=t(2624);let ex=(0,t(85738).ax)({id:137,name:"Polygon",nativeCurrency:{name:"MATIC",symbol:"MATIC",decimals:18},blockExplorers:[{name:"PolygonScan",url:"https://polygonscan.com",apiUrl:"https://api.polygonscan.com/api"}]});var eh=t(6354),em=t(96856);function ey(e){var n,t;let r;let s=(0,x.L)(e.chain);return(0,o.jsxs)(E.Container,{children:[(0,o.jsx)("div",{onClick:e=>{var n;null===(n=e.currentTarget.querySelector("input"))||void 0===n||n.focus()},children:(0,o.jsxs)(E.Container,{flex:"row",center:"both",gap:"xs",style:{flexWrap:"nowrap"},children:[(0,o.jsx)(em.Input,{variant:"outline",pattern:"^[0-9]*[.,]?[0-9]*$",inputMode:"decimal",tabIndex:-1,placeholder:"0",type:"text","data-placeholder":""===e.value,value:e.value||"0",disabled:e.freezeAmount,onClick:n=>{""===e.value&&n.currentTarget.setSelectionRange(n.currentTarget.value.length,n.currentTarget.value.length)},onChange:n=>{let t=n.target.value;t.startsWith(".")&&(t="0".concat(t)),Number.isNaN(Number(t))||(t.startsWith("0")&&!t.startsWith("0.")?e.onChange(t.slice(1)):e.onChange(t))},style:{border:"none",fontSize:(t=e.value).length>10?"26px":t.length>6?"34px":"50px",boxShadow:"none",borderRadius:"0",padding:"0",paddingBlock:"2px",fontWeight:600,textAlign:"right",width:(r=e.value.replace(".","").length,e.value.includes(".")&&(r+=.3),"calc(".concat("".concat(Math.max(1,r),"ch")," + 6px)")),maxWidth:"calc(100% - 100px)"}}),(0,o.jsx)(z.TokenSymbol,{token:e.token,chain:e.chain,size:"lg",color:"secondaryText"})]})}),!e.hideTokenSelector&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(S.L,{y:"sm"}),(0,o.jsx)(E.Container,{flex:"row",center:"x",children:(0,o.jsxs)(ep,{variant:"secondary",fullWidth:!0,style:{fontSize:u.JB.sm},gap:"xxs",onClick:e.onSelectToken,disabled:e.freezeChainAndToken,children:[(0,o.jsxs)(E.Container,{flex:"row",center:"y",gap:"sm",children:[(0,o.jsx)(L.TokenIcon,{token:e.token,chain:e.chain,size:"md",client:e.client}),(0,o.jsxs)(E.Container,{flex:"column",style:{gap:"4px"},children:[(0,o.jsx)(z.TokenSymbol,{token:e.token,chain:e.chain,size:"sm"}),(null===(n=s.data)||void 0===n?void 0:n.name)?(0,o.jsx)(W.Text,{size:"xs",color:"secondaryText",children:s.data.name}):(0,o.jsx)(w.Skeleton,{width:"90px",height:u.JB.xs})]})]}),(0,o.jsx)(i.v4q,{width:u.EA.sm,height:u.EA.sm,style:{marginLeft:"auto"}})]})})]})]})}let ep=(0,_.Z)(F.Button)(()=>{let e=(0,H.useCustomTheme)();return{background:e.colors.tertiaryBg,border:"1px solid ".concat(e.colors.borderColor),justifyContent:"flex-start",transition:"background 0.3s",padding:u.W0.sm}});var ef=t(79515),ej=t(63391),eg=t(45164);function eT(e){var n;let t=(0,x.L)(e.chain),r=(0,g.M)(),s=(0,h.t)({address:null==r?void 0:r.address,chain:e.chain,tokenAddress:(0,I.M)(e.token)?void 0:e.token.address,client:e.client});return(0,o.jsxs)(E.Container,{bg:"tertiaryBg",borderColor:"borderColor",flex:"row",style:{borderRadius:u.q0.md,borderBottomRightRadius:0,borderBottomLeftRadius:0,borderWidth:"1px",borderStyle:"solid",borderBottom:"none",flexWrap:"nowrap",justifyContent:"space-between",minHeight:"64px",alignItems:"center"},children:[(0,o.jsxs)(F.Button,{variant:"ghost",onClick:e.onSelectToken,gap:"sm",style:{paddingInline:u.W0.sm,paddingBlock:u.W0.sm,minWidth:"50%",justifyContent:"flex-start"},disabled:e.freezeChainAndTokenSelection,children:[(0,o.jsx)(O.K,{token:e.token,chain:e.chain,size:"md",client:e.client}),(0,o.jsxs)(E.Container,{flex:"column",gap:"xxs",children:[(0,o.jsxs)(E.Container,{flex:"row",gap:"xs",center:"y",color:"primaryText",children:[(0,o.jsx)(z.TokenSymbol,{token:e.token,chain:e.chain,size:"sm"}),(0,o.jsx)(i.v4q,{width:u.EA.sm,height:u.EA.sm})]}),(null===(n=t.data)||void 0===n?void 0:n.name)?(0,o.jsxs)(W.Text,{size:"xs",children:[" ",t.data.name]}):(0,o.jsx)(w.Skeleton,{width:"90px",height:u.JB.xs})]})]}),(0,o.jsxs)("div",{style:{flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",alignItems:"flex-end",gap:u.W0.xxs,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",justifyContent:"center",paddingRight:u.W0.sm},children:[e.isLoading?(0,o.jsx)(w.Skeleton,{width:"120px",height:u.JB.md,color:"borderColor"}):(0,o.jsx)(W.Text,{size:"md",color:e.value?"primaryText":"secondaryText",style:{},children:(0,d.u)(Number(e.value),4)||"--"}),(0,o.jsxs)(E.Container,{flex:"row",gap:"xxs",center:"y",color:"secondaryText",children:[(0,o.jsx)(ej.D,{size:u.JB.xs}),s.data?(0,o.jsx)(W.Text,{size:"xs",color:"secondaryText",weight:500,children:(0,eg.a)(s.data,!0)}):(0,o.jsx)(w.Skeleton,{width:"70px",height:u.JB.xs})]})]})]})}var eb=t(27214),ev=t(80383);function eC(e){let n=(0,ev.oU)(e.client);return n.data?(0,o.jsx)(ek,{...e,onViewPendingTx:e.onViewPendingTx,supportedDestinations:n.data,buyForTx:e.buyForTx}):(0,o.jsx)(b.a,{})}function ek(e){var n,t,i,a,l,u,h,m,y,p;let{client:f,supportedDestinations:j,connectLocale:b,payOptions:v,buyForTx:w}=e,S=(0,g.M)(),B=(0,T.v)();(0,x.f)(j.map(e=>e.chain)||[],50);let{screen:A,setScreen:L,drawerScreen:F,setDrawerScreen:W,drawerRef:z,drawerOverlayRef:D,closeDrawer:R}=function(){let[e,n]=(0,r.useState)({id:"main"}),[t,o]=(0,r.useState)(),{drawerRef:i,drawerOverlayRef:s,onClose:a}=(0,C.useDrawer)();return{screen:e,setScreen:n,drawerScreen:t,setDrawerScreen:o,drawerRef:i,drawerOverlayRef:s,closeDrawer:function(){a(()=>{o(void 0)})}}}(),{tokenAmount:M,setTokenAmount:N,toChain:q,setToChain:O,deferredTokenAmount:_,fromChain:V,setFromChain:U,toToken:H,setToToken:Q,fromToken:Y,setFromToken:G,selectedCurrency:Z,setSelectedCurrency:$}=function(e){var n,t,o,i,s,a,l,u;let x=(0,T.v)(),{payOptions:h,buyForTx:m,supportedDestinations:y}=e,p=(null===(n=h.prefillBuy)||void 0===n?void 0:n.amount)||(m?String((0,d.u)(Number((0,c.n9)(m.cost-m.balance)),4)):""),[f,j]=(0,r.useState)(p),g=(0,eh.c)(f,300),[b,v]=(0,r.useState)((null===(t=h.prefillBuy)||void 0===t?void 0:t.chain)||(null==m?void 0:m.tx.chain)||(null===(o=y.find(e=>e.chain.id===(null==x?void 0:x.id)))||void 0===o?void 0:o.chain)||ex),[C,k]=(0,r.useState)((null===(i=h.prefillBuy)||void 0===i?void 0:i.token)||I.L),[w,S]=(0,r.useState)(!1!==h.buyWithCrypto&&(null===(a=h.buyWithCrypto)||void 0===a?void 0:null===(s=a.prefillSource)||void 0===s?void 0:s.chain)||ex),[B,A]=(0,r.useState)(!1!==h.buyWithCrypto&&(null===(u=h.buyWithCrypto)||void 0===u?void 0:null===(l=u.prefillSource)||void 0===l?void 0:l.token)||I.L),[L,E]=(0,r.useState)(K.k8);return{tokenAmount:f,setTokenAmount:j,toChain:b,setToChain:v,deferredTokenAmount:g,fromChain:w,setFromChain:S,toToken:C,setToToken:k,fromToken:B,setFromToken:A,selectedCurrency:L,setSelectedCurrency:E}}({payOptions:v,buyForTx:w,supportedDestinations:j}),X=(0,ev.QR)({client:e.client,destinationChainId:q.id,destinationTokenAddress:(0,I.M)(H)?s.K8:H.address}),ee=(0,r.useMemo)(()=>eW(j,v,e.supportedTokens),[e.supportedTokens,j,v]),en=(0,r.useMemo)(()=>{if(X.data)return eW(X.data,v,e.supportedTokens)},[e.supportedTokens,X.data,v]);if("node"===A.id)return A.node;if("select-currency"===A.id){let e=()=>L(A.backScreen);return(0,o.jsx)(J,{onSelect:n=>{e(),$(n)},onBack:e})}if("select-to-token"===A.id){let r=j.map(e=>e.chain),l=()=>L(A.backScreen);return(null===(t=v.prefillBuy)||void 0===t?void 0:null===(n=t.allowEdits)||void 0===n?void 0:n.token)===!1?(0,o.jsx)(ez,{chains:r,client:e.client,connectLocale:e.connectLocale,setChain:O,goBack:l}):(0,o.jsx)(P.k,{onBack:l,tokenList:(((null==q?void 0:q.id)?ee[q.id]:void 0)||[]).filter(e=>e.address!==s.K8),onTokenSelect:e=>{Q(e),l()},chain:q,chainSelection:(null===(a=v.prefillBuy)||void 0===a?void 0:null===(i=a.allowEdits)||void 0===i?void 0:i.chain)!==!1?{chains:r,select:e=>{O(e)}}:void 0,connectLocale:b,client:f,modalTitle:"Buy"})}if("select-from-token"===A.id&&X.data&&en){let n=X.data.map(e=>e.chain),t=()=>L(A.backScreen);return!1!==v.buyWithCrypto&&(null===(h=v.buyWithCrypto)||void 0===h?void 0:null===(u=h.prefillSource)||void 0===u?void 0:null===(l=u.allowEdits)||void 0===l?void 0:l.token)===!1?(0,o.jsx)(ez,{chains:n,client:e.client,connectLocale:e.connectLocale,setChain:U,goBack:t}):(0,o.jsx)(P.k,{onBack:t,tokenList:(((null==V?void 0:V.id)?en[V.id]:void 0)||[]).filter(e=>e.address!==s.K8),onTokenSelect:e=>{G(e),t()},chain:V,chainSelection:!1!==v.buyWithCrypto&&(null===(p=v.buyWithCrypto)||void 0===p?void 0:null===(y=p.prefillSource)||void 0===y?void 0:null===(m=y.allowEdits)||void 0===m?void 0:m.chain)!==!1?{chains:X.data.map(e=>e.chain),select:e=>U(e)}:void 0,connectLocale:b,client:f,modalTitle:"Pay with"})}return(0,o.jsx)(E.Container,{animate:"fadein",children:(0,o.jsxs)("div",{onClick:e=>{F&&z.current&&!z.current.contains(e.target)&&(e.preventDefault(),e.stopPropagation(),R())},children:[F&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(C.DrawerOverlay,{ref:D}),(0,o.jsx)(C.Drawer,{ref:z,close:R,children:(0,o.jsx)(k.DynamicHeight,{children:F})})]}),"main"===A.id&&(0,o.jsx)(eS,{account:S||null,buyForTx:w||null,client:f,onSelectBuyToken:()=>L({id:"select-to-token",backScreen:A}),payOptions:v,setTokenAmount:N,toChain:q,toToken:H,tokenAmount:M,connectButton:e.connectButton,onViewPendingTx:e.onViewPendingTx,setScreen:L,supportedDestinations:j}),("select-payment-method"===A.id||"buy-with-crypto"===A.id||"buy-with-fiat"===A.id)&&(0,o.jsxs)(eB,{selectedChain:q,selectedToken:H,tokenAmount:M,client:f,onBack:()=>{"buy-with-crypto"===A.id||"buy-with-fiat"===A.id?L({id:"select-payment-method"}):"select-payment-method"===A.id&&L({id:"main"})},children:["select-payment-method"===A.id&&(0,o.jsx)(eA,{setScreen:e=>L({id:e})}),"buy-with-crypto"===A.id&&S&&B&&(0,o.jsx)(eL,{setScreen:L,setDrawerScreen:W,tokenAmount:_,toChain:q,toToken:H,fromChain:V,fromToken:Y,showFromTokenSelector:()=>{L({id:"select-from-token",backScreen:A})},account:S,activeChain:B,buyForTx:w||null,client:f,isEmbed:e.isEmbed,onDone:e.onDone,onViewPendingTx:e.onViewPendingTx,payOptions:v}),"buy-with-fiat"===A.id&&S&&B&&(0,o.jsx)(eE,{setScreen:L,setDrawerScreen:W,tokenAmount:_,toChain:q,toToken:H,selectedCurrency:Z,buyForTx:w||null,client:f,isEmbed:e.isEmbed,onDone:e.onDone,onViewPendingTx:e.onViewPendingTx,payOptions:v,theme:e.theme,showCurrencySelector:()=>{L({id:"select-currency",backScreen:A})},account:S})]})]})})}function ew(e){return(0,o.jsx)("div",{children:(0,o.jsxs)(E.Container,{flex:"row",gap:"sm",center:"y",style:{justifyContent:"space-between"},children:[(0,o.jsxs)(E.Container,{flex:"row",gap:"xs",center:"y",children:[(0,o.jsx)(W.Text,{color:"primaryText","data-testid":"tokenAmount",size:"xxl",children:(0,d.u)(Number(e.tokenAmount),3)}),(0,o.jsxs)(E.Container,{flex:"row",gap:"xxs",center:"y",children:[(0,o.jsx)(z.TokenSymbol,{token:e.selectedToken,chain:e.selectedChain,size:"md",color:"secondaryText"}),(0,o.jsx)(O.K,{chain:e.selectedChain,client:e.client,size:"sm",token:e.selectedToken})]})]}),(0,o.jsx)(v.G,{chain:e.selectedChain,client:e.client,size:"sm",short:!0})]})})}function eS(e){var n,t,i,a,l,x;let{showPaymentSelection:h,buyWithCryptoEnabled:m,buyWithFiatEnabled:y}=function(e){let{payOptions:n,supportedDestinations:t,toChain:o,toToken:i}=e,{fiat:r,swap:a}=function(){let e=t.find(e=>e.chain.id===o.id);if(!e)return{fiat:!0,swap:!0};let n=(0,I.M)(i)?s.K8:i.address,r=e.tokens.find(e=>e.address.toLowerCase()===n.toLowerCase());return r?{fiat:r.buyWithFiatEnabled,swap:r.buyWithCryptoEnabled}:{fiat:!0,swap:!0}}(),l=!1!==n.buyWithFiat&&r,d=!1!==n.buyWithCrypto&&a;return{buyWithFiatEnabled:l,buyWithCryptoEnabled:d,showPaymentSelection:l&&d}}({payOptions:e.payOptions,supportedDestinations:e.supportedDestinations,toChain:e.toChain,toToken:e.toToken}),[p,f]=(0,r.useState)(!1),{buyForTx:j,setTokenAmount:g,account:T,client:b,tokenAmount:v,payOptions:C,toToken:k,toChain:w}=e,{amountNeeded:B}=function(e){let{buyForTx:n,hasEditedAmount:t,setTokenAmount:o,account:i}=e,s=!t,[a,l]=(0,r.useState)(null==n?void 0:n.cost);return(0,r.useEffect)(()=>{if(!n)return;let e=!0;async function t(){if(n&&e){try{let t=await (0,ec.u)(n.tx,null==i?void 0:i.address);if(!e)return;if(l(t),s&&t>n.balance){let e=String((0,d.u)(Number((0,c.n9)(t-n.balance)),4));o(e)}}catch(e){}await (0,eu.D)(3e4),t()}}return t(),()=>{e=!1}},[n,s,o,i]),{amountNeeded:a}}({setTokenAmount:g,buyForTx:j,hasEditedAmount:p,account:T}),A=!v;return(0,o.jsxs)(E.Container,{p:"lg",children:[(0,o.jsx)(E.ModalHeader,{title:e.buyForTx?"Not enough ".concat(e.buyForTx.tokenSymbol):"Buy"}),B&&e.buyForTx?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(S.L,{y:"lg"}),(0,o.jsx)(eF,{amountNeeded:String((0,d.u)(Number((0,c.n9)(B)),4)),buyForTx:e.buyForTx,client:b})]}):(0,o.jsx)(S.L,{y:"xl"}),(0,o.jsx)(ey,{value:v,onChange:async e=>{f(!0),g(e)},freezeAmount:(null===(t=C.prefillBuy)||void 0===t?void 0:null===(n=t.allowEdits)||void 0===n?void 0:n.amount)===!1,freezeChainAndToken:(null===(a=C.prefillBuy)||void 0===a?void 0:null===(i=a.allowEdits)||void 0===i?void 0:i.chain)===!1&&(null===(x=C.prefillBuy)||void 0===x?void 0:null===(l=x.allowEdits)||void 0===l?void 0:l.token)===!1,token:k,chain:w,onSelectToken:e.onSelectBuyToken,client:e.client,hideTokenSelector:!!e.buyForTx}),(0,o.jsx)(S.L,{y:"xl"}),(0,o.jsxs)(E.Container,{flex:"column",gap:"sm",children:[!T&&e.connectButton?(0,o.jsx)("div",{children:e.connectButton}):(0,o.jsx)(F.Button,{variant:"accent",fullWidth:!0,disabled:A,"data-disabled":A,onClick:()=>{h?e.setScreen({id:"select-payment-method"}):m?e.setScreen({id:"buy-with-crypto"}):y?e.setScreen({id:"buy-with-fiat"}):console.error("No payment method enabled")},children:"Continue"}),T&&(0,o.jsx)(F.Button,{variant:"outline",fullWidth:!0,style:{padding:u.W0.xs,fontSize:u.JB.sm},onClick:e.onViewPendingTx,children:"View all transactions"})]})]})}function eB(e){return(0,o.jsxs)(E.Container,{children:[(0,o.jsx)(E.Container,{p:"lg",children:(0,o.jsx)(E.ModalHeader,{title:"Buy",onBack:e.onBack})}),(0,o.jsxs)(E.Container,{px:"lg",style:{paddingBottom:u.W0.lg},children:[(0,o.jsx)(S.L,{y:"xs"}),(0,o.jsx)(ew,{selectedToken:e.selectedToken,selectedChain:e.selectedChain,tokenAmount:e.tokenAmount,client:e.client}),(0,o.jsx)(S.L,{y:"md"}),(0,o.jsx)(E.Line,{}),(0,o.jsx)(S.L,{y:"lg"}),(0,o.jsx)(W.Text,{size:"sm",children:" Pay with "}),(0,o.jsx)(S.L,{y:"sm"}),e.children]})]})}function eA(e){return(0,o.jsx)(E.Container,{animate:"fadein",children:(0,o.jsxs)(E.Container,{flex:"column",gap:"sm",children:[(0,o.jsxs)(F.Button,{variant:"outline",bg:"tertiaryBg",onClick:()=>e.setScreen("buy-with-fiat"),gap:"sm",style:{justifyContent:"flex-start",textAlign:"left"},children:[(0,o.jsx)(E.Container,{color:"secondaryText",flex:"row",center:"both",children:(0,o.jsx)(i.Xwj,{style:{width:u.EA.md,height:u.EA.md}})}),(0,o.jsxs)(E.Container,{flex:"column",gap:"xxs",children:[(0,o.jsx)(W.Text,{size:"md",color:"primaryText",children:"Credit Card"}),(0,o.jsx)(W.Text,{size:"xs",children:"Easily and securely make payments"})]})]}),(0,o.jsxs)(F.Button,{variant:"outline",bg:"tertiaryBg",onClick:()=>e.setScreen("buy-with-crypto"),style:{justifyContent:"flex-start"},gap:"sm",children:[(0,o.jsx)(E.Container,{color:"secondaryText",flex:"row",center:"both",children:(0,o.jsx)(R.O,{size:u.EA.md})}),(0,o.jsxs)(E.Container,{flex:"column",gap:"xxs",children:[(0,o.jsx)(W.Text,{size:"md",color:"primaryText",children:"Crypto"}),(0,o.jsx)(W.Text,{size:"xs",children:"Pay with confidence using crypto"})]})]})]})})}function eL(e){var n,t,i,r,a,l;let{setDrawerScreen:d,setScreen:c,account:u,client:x,toChain:p,tokenAmount:f,toToken:j,fromChain:g,fromToken:T,showFromTokenSelector:b,payOptions:v}=e,C=(0,h.t)({address:u.address,chain:g,tokenAddress:(0,I.M)(T)?void 0:T.address,client:x}),k=(l=f&&!(g.id===p.id&&T===j)?{fromAddress:u.address,fromChainId:g.id,fromTokenAddress:(0,I.M)(T)?s.K8:T.address,toChainId:p.id,toTokenAddress:(0,I.M)(j)?s.K8:j.address,toAmount:f,client:x,purchaseData:v.purchaseData}:void 0,(0,m.useQuery)({staleTime:3e4,refetchInterval:3e4,gcTime:3e4,queryKey:["buyWithCryptoQuote",l],queryFn:()=>{if(!l)throw Error("Swap params are required");return(0,y.D)(l)},enabled:!!l,retry:(e,n)=>!(e>3||n.message.includes("Minimum purchase"))})),w=null===(n=k.data)||void 0===n?void 0:n.swapDetails.fromAmount,L=!!w&&!!C.data&&Number(C.data.displayValue)<Number(w),z=!k.data||L,D=e.activeChain.id!==g.id,R=!1!==v.buyWithCrypto?null===(t=v.buyWithCrypto)||void 0===t?void 0:t.prefillSource:void 0;return(0,o.jsxs)(E.Container,{flex:"column",gap:"md",animate:"fadein",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)(eT,{value:w||"",onSelectToken:b,chain:g,token:T,isLoading:k.isLoading&&!w,client:x,freezeChainAndTokenSelection:(null==R?void 0:null===(i=R.allowEdits)||void 0===i?void 0:i.chain)===!1&&(null==R?void 0:null===(r=R.allowEdits)||void 0===r?void 0:r.token)===!1}),(0,o.jsx)(N,{quoteIsLoading:k.isLoading,estimatedSeconds:null===(a=k.data)||void 0===a?void 0:a.swapDetails.estimated.durationSeconds,onViewFees:function(){k.data&&d((0,o.jsxs)("div",{children:[(0,o.jsx)(W.Text,{size:"lg",color:"primaryText",children:"Fees"}),(0,o.jsx)(S.L,{y:"lg"}),(0,o.jsx)(ef.O,{quote:k.data,align:"left"})]}))}})]}),k.error&&(0,o.jsx)(W.Text,{color:"danger",size:"sm",center:!0,children:function(e){let n="Unable to get price quote";try{if(e instanceof Error&&e.message.includes("Minimum"))return e.message.replace("Fetch failed: Error: ","");return n}catch(e){return n}}(k.error)}),!D||k.isLoading||L||k.error?(0,o.jsx)(F.Button,{variant:z?"outline":"accent",fullWidth:!0,"data-disabled":z,disabled:z,onClick:async()=>{z||!k.data||c({id:"node",node:(0,o.jsx)(eb.$,{isBuyForTx:!!e.buyForTx,isEmbed:e.isEmbed,client:x,onBack:()=>{c({id:"buy-with-crypto"})},buyWithCryptoQuote:k.data,account:u,onViewPendingTx:e.onViewPendingTx,isFiatFlow:!1,onDone:e.onDone,onTryAgain:()=>{c({id:"buy-with-crypto"}),k.refetch()}})})},gap:"xs",children:L?(0,o.jsx)(W.Text,{color:"danger",children:"Not Enough Funds"}):k.isLoading?(0,o.jsxs)(o.Fragment,{children:["Getting price quote",(0,o.jsx)(B.Spinner,{size:"sm",color:"accentText"})]}):"Continue"}):(0,o.jsx)(A.v,{variant:"accent",fullWidth:!0,chain:g})]})}function eE(e){var n,t,i;let{toToken:r,tokenAmount:a,account:d,client:c,setScreen:u,setDrawerScreen:x,toChain:h,showCurrencySelector:y,selectedCurrency:p}=e,f=e.payOptions.buyWithFiat,g=(i=!1!==f&&a?{fromCurrencySymbol:p.shorthand,toChainId:h.id,toAddress:d.address,toTokenAddress:(0,I.M)(r)?s.K8:r.address,toAmount:a,client:c,isTestMode:null==f?void 0:f.testMode,purchaseData:e.payOptions.purchaseData,fromAddress:d.address}:void 0,(0,m.useQuery)({queryKey:["useBuyWithFiatQuote",i],queryFn:async()=>{if(!i)throw Error("No params provided");return j(i)},enabled:!!i,retry(e,n){if(e>3)return!1;try{if("MINIMUM_PURCHASE_AMOUNT"===n.error.code)return!1}catch(e){}return!0}})),T=!g.data;return(0,o.jsxs)(E.Container,{flex:"column",gap:"md",animate:"fadein",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)(V,{isLoading:g.isLoading,value:null===(n=g.data)||void 0===n?void 0:n.fromCurrencyWithFees.amount,client:c,currency:p,onSelectCurrency:y}),(0,o.jsx)(N,{quoteIsLoading:g.isLoading,estimatedSeconds:null===(t=g.data)||void 0===t?void 0:t.estimatedDurationSeconds,onViewFees:function(){g.data&&x((0,o.jsxs)("div",{children:[(0,o.jsx)(W.Text,{size:"lg",color:"primaryText",children:"Fees"}),(0,o.jsx)(S.L,{y:"lg"}),(0,o.jsx)(ef.W,{quote:g.data})]}))}})]}),g.error&&(0,o.jsx)("div",{children:(function(e){try{if("MINIMUM_PURCHASE_AMOUNT"===e.error.code){let n=e.error;return["Minimum purchase amount is $".concat(n.data.minimumAmountUSDCents/100),"Requested amount is $".concat(n.data.requestedAmountUSDCents/100)]}}catch(e){}return["Unable to get price quote"]})(g.error).map(e=>(0,o.jsx)(W.Text,{color:"danger",size:"sm",center:!0,multiline:!0,children:e},e))}),(0,o.jsx)(F.Button,{variant:T?"outline":"accent","data-disabled":T,disabled:T,fullWidth:!0,onClick:function(){if(!g.data)return;let n=l(g.data),t=null;n||(t=Y(g.data.onRampLink,"string"==typeof e.theme?e.theme:e.theme.type),(0,G.h)({type:"fiat",intentId:g.data.intentId})),u({id:"node",node:(0,o.jsx)(ed,{isBuyForTx:!!e.buyForTx,quote:g.data,onBack:()=>{u({id:"buy-with-fiat"})},client:c,testMode:!1!==f&&((null==f?void 0:f.testMode)||!1),theme:"string"==typeof e.theme?e.theme:e.theme.type,onViewPendingTx:e.onViewPendingTx,openedWindow:t,onDone:e.onDone,isEmbed:e.isEmbed})})},gap:"xs",children:g.isLoading?(0,o.jsxs)(o.Fragment,{children:["Getting price quote",(0,o.jsx)(B.Spinner,{size:"sm",color:"accentText"})]}):"Continue"})]})}function eF(e){let n=(0,x.L)(e.buyForTx.tx.chain);return(0,o.jsxs)(E.Container,{children:[(0,o.jsx)(S.L,{y:"xs"}),(0,o.jsxs)(E.Container,{flex:"row",style:{justifyContent:"space-between"},children:[(0,o.jsx)(W.Text,{size:"sm",children:"Amount Needed"}),(0,o.jsxs)(E.Container,{flex:"column",style:{alignItems:"flex-end"},children:[(0,o.jsxs)(E.Container,{flex:"row",gap:"xs",center:"y",children:[(0,o.jsxs)(W.Text,{color:"primaryText",size:"sm",children:[e.amountNeeded," ",e.buyForTx.tokenSymbol]}),(0,o.jsx)(L.TokenIcon,{chain:e.buyForTx.tx.chain,client:e.client,size:"sm",token:I.L})]}),(0,o.jsx)(S.L,{y:"xxs"}),n.data?(0,o.jsxs)(W.Text,{size:"sm",children:[" ",n.data.name]}):(0,o.jsx)(w.Skeleton,{height:u.JB.sm,width:"50px"})]})]}),(0,o.jsx)(S.L,{y:"md"}),(0,o.jsx)(E.Line,{}),(0,o.jsx)(S.L,{y:"md"}),(0,o.jsxs)(E.Container,{flex:"row",style:{justifyContent:"space-between"},children:[(0,o.jsx)(W.Text,{size:"sm",children:"Your Balance"}),(0,o.jsxs)(E.Container,{flex:"row",gap:"xs",children:[(0,o.jsxs)(W.Text,{color:"primaryText",size:"sm",children:[(0,d.u)(Number((0,c.n9)(e.buyForTx.balance)),4)," ",e.buyForTx.tokenSymbol]}),(0,o.jsx)(L.TokenIcon,{chain:e.buyForTx.tx.chain,client:e.client,size:"sm",token:I.L})]})]}),(0,o.jsx)(S.L,{y:"md"}),(0,o.jsx)(E.Line,{}),(0,o.jsx)(S.L,{y:"xl"}),(0,o.jsx)(W.Text,{center:!0,size:"sm",children:"Purchase"}),(0,o.jsx)(S.L,{y:"xxs"})]})}function eW(e,n,t){let o={},i=!1===n.buyWithFiat,r=!1===n.buyWithCrypto;for(let n of e)o[n.chain.id]=n.tokens.filter(e=>!!e.buyWithCryptoEnabled&&!!e.buyWithFiatEnabled||(!!e.buyWithCryptoEnabled||!i)&&(!!e.buyWithFiatEnabled||!r));if(t)for(let e in t){let n=Number(e),i=t[n];i&&(o[n]=i)}return o}function ez(e){return(0,o.jsx)(D.NetworkSelectorContent,{client:e.client,connectLocale:e.connectLocale,showTabs:!1,onBack:e.goBack,chains:e.chains,closeModal:e.goBack,networkSelector:{renderChain:n=>(0,o.jsx)(D.ChainButton,{chain:n.chain,confirming:!1,switchingFailed:!1,onClick:()=>{e.setChain(n.chain),e.goBack()},client:e.client,connectLocale:e.connectLocale})}})}},94071:function(e,n,t){t.r(n),t.d(n,{Drawer:function(){return y},DrawerContainer:function(){return p},DrawerOverlay:function(){return j},drawerOpenAnimation:function(){return f},useDrawer:function(){return g}});var o=t(56093),i=t(3827),r=t(34686),s=t(62177),a=t(64090),l=t(4966),d=t(72568),c=t(96635),u=t(58852),x=t(18329),h=t(3702);function m(){let e=(0,o._)(["\n  from {\n    opacity: 0;\n    transform: translateY(100px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n"]);return m=function(){return e},e}let y=(0,a.forwardRef)(function(e,n){return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(p,{ref:n,children:[(0,i.jsx)(x.CrossContainer,{children:(0,i.jsx)(h.IconButton,{type:"button","aria-label":"Close",onClick:e.close,children:(0,i.jsx)(s.Pxu,{width:d.EA.md,height:d.EA.md,style:{color:"inherit"}})})}),e.children]})})}),p=(0,u.lx)(e=>{let n=(0,l.useCustomTheme)();return{zIndex:1e4,padding:d.W0.lg,borderTopLeftRadius:d.q0.xl,borderTopRightRadius:d.q0.xl,background:n.colors.modalBg,position:"absolute",bottom:0,left:0,right:0,animation:"".concat(f," 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.1)"),borderTop:"1px solid ".concat(n.colors.borderColor)}}),f=(0,r.F4)(m()),j=(0,u.lx)(e=>({backgroundColor:(0,l.useCustomTheme)().colors.modalOverlayBg,zIndex:9999,position:"absolute",inset:0,animation:"".concat(c.BX," 400ms cubic-bezier(0.16, 1, 0.3, 1)")}));function g(){let e=(0,a.useRef)(null),n=(0,a.useRef)(null);return{drawerRef:e,drawerOverlayRef:n,onClose:t=>{if(e.current){var o;let i={easing:"cubic-bezier(0.175, 0.885, 0.32, 1.1)",fill:"forwards",duration:300},r=e.current.animate([{transform:"translateY(100%)",opacity:0}],i);null===(o=n.current)||void 0===o||o.animate([{opacity:0}],i),r.onfinish=t}else t()}}}}}]);