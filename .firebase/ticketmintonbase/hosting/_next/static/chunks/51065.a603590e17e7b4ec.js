"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[51065],{51065:function(e,t,r){r.d(t,{autoConnectWC:function(){return Y},connectWC:function(){return G}});var n=r(89995),a=r(80230),o=r(92791),i=r(48036);class s extends a.G{constructor({body:e,error:t,url:r}){super("RPC Request failed.",{cause:t,details:t.message,metaMessages:["URL: ".concat((0,i.Gr)(r)),"Request body: ".concat((0,o.P)(e))]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcRequestError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.code=t.code}}class c extends a.G{constructor(e,{code:t,docsPath:r,metaMessages:n,shortMessage:a}){super(a,{cause:e,docsPath:r,metaMessages:n||(null==e?void 0:e.metaMessages)}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.code=e instanceof s?e.code:null!=t?t:-1}}class l extends c{constructor(e,t){super(e,t),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ProviderRpcError"}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=t.data}}class d extends c{constructor(e){super(e,{code:d.code,shortMessage:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ParseRpcError"})}}Object.defineProperty(d,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32700});class u extends c{constructor(e){super(e,{code:u.code,shortMessage:"JSON is not a valid request object."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidRequestRpcError"})}}Object.defineProperty(u,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32600});class b extends c{constructor(e){super(e,{code:b.code,shortMessage:"The method does not exist / is not available."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"MethodNotFoundRpcError"})}}Object.defineProperty(b,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32601});class h extends c{constructor(e){super(e,{code:h.code,shortMessage:"Invalid parameters were provided to the RPC method.\nDouble check you have provided the correct parameters."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidParamsRpcError"})}}Object.defineProperty(h,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602});class p extends c{constructor(e){super(e,{code:p.code,shortMessage:"An internal error was received."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InternalRpcError"})}}Object.defineProperty(p,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32603});class v extends c{constructor(e){super(e,{code:v.code,shortMessage:"Missing or invalid parameters.\nDouble check you have provided the correct parameters."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidInputRpcError"})}}Object.defineProperty(v,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32e3});class f extends c{constructor(e){super(e,{code:f.code,shortMessage:"Requested resource not found."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ResourceNotFoundRpcError"})}}Object.defineProperty(f,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32001});class m extends c{constructor(e){super(e,{code:m.code,shortMessage:"Requested resource not available."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ResourceUnavailableRpcError"})}}Object.defineProperty(m,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32002});class g extends c{constructor(e){super(e,{code:g.code,shortMessage:"Transaction creation failed."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"TransactionRejectedRpcError"})}}Object.defineProperty(g,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32003});class w extends c{constructor(e){super(e,{code:w.code,shortMessage:"Method is not implemented."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"MethodNotSupportedRpcError"})}}Object.defineProperty(w,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32004});class y extends c{constructor(e){super(e,{code:y.code,shortMessage:"Request exceeds defined limit."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"LimitExceededRpcError"})}}Object.defineProperty(y,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32005});class P extends c{constructor(e){super(e,{code:P.code,shortMessage:"Version of JSON-RPC protocol is not supported."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"JsonRpcVersionUnsupportedError"})}}Object.defineProperty(P,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32006});class C extends l{constructor(e){super(e,{code:C.code,shortMessage:"User rejected the request."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UserRejectedRequestError"})}}Object.defineProperty(C,"code",{enumerable:!0,configurable:!0,writable:!0,value:4001});class O extends l{constructor(e){super(e,{code:O.code,shortMessage:"The requested method and/or account has not been authorized by the user."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnauthorizedProviderError"})}}Object.defineProperty(O,"code",{enumerable:!0,configurable:!0,writable:!0,value:4100});class j extends l{constructor(e){super(e,{code:j.code,shortMessage:"The Provider does not support the requested method."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnsupportedProviderMethodError"})}}Object.defineProperty(j,"code",{enumerable:!0,configurable:!0,writable:!0,value:4200});class M extends l{constructor(e){super(e,{code:M.code,shortMessage:"The Provider is disconnected from all chains."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ProviderDisconnectedError"})}}Object.defineProperty(M,"code",{enumerable:!0,configurable:!0,writable:!0,value:4900});class E extends l{constructor(e){super(e,{code:E.code,shortMessage:"The Provider is not connected to the requested chain."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ChainDisconnectedError"})}}Object.defineProperty(E,"code",{enumerable:!0,configurable:!0,writable:!0,value:4901});class R extends l{constructor(e){super(e,{code:R.code,shortMessage:"An error occurred when attempting to switch chain."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"SwitchChainError"})}}Object.defineProperty(R,"code",{enumerable:!0,configurable:!0,writable:!0,value:4902});var x=r(85738),I=r(14520),q=r(23416),N=r(14649),T=r(86359),U=r(30792),_=r(83286),S=r(24053),J=r(15168),D=r(68652),L=r(81027);let k="wallet_addEthereumChain",A={requestedChains:"tw.wc.requestedChains",lastUsedChainId:"tw.wc.lastUsedChainId"};async function G(e,t,r,n,a){var o,i,s;let c=await X(e,r,a),l=e.walletConnect,{onDisplayUri:d}=l||{};if(!d&&a&&"walletConnect"!==r){let e=await (0,q.d)(r);d=t=>{let r=e.mobile.native||e.mobile.universal;if(!r)throw Error("No app url found for wallet connect to redirect to.");a((0,D.P)(r,t).redirect)}}d&&c.events.addListener("display_uri",d);let{rpcMap:u,chainsToRequest:b}=W({client:e.client,chain:e.chain,optionalChains:null===(o=e.walletConnect)||void 0===o?void 0:o.optionalChains});c.session&&await c.connect({...(null==l?void 0:l.pairingTopic)?{pairingTopic:null==l?void 0:l.pairingTopic}:{},optionalChains:b,chains:e.chain?[e.chain.id]:b.length>0?[b[0]]:[1],rpcMap:u}),z(b,n);let h=(await c.enable())[0];if(!h)throw Error("No accounts found on provider.");let p=(0,U.J)(c.chainId),v=e.chain&&e.chain.id===p?e.chain:(0,x.XY)(p);if(e){let t={optionalChains:null===(i=e.walletConnect)||void 0===i?void 0:i.optionalChains,chain:e.chain,pairingTopic:null===(s=e.walletConnect)||void 0===s?void 0:s.pairingTopic};n&&(0,J.j$)(n,r,t)}return(null==l?void 0:l.onDisplayUri)&&c.events.removeListener("display_uri",l.onDisplayUri),Q(h,v,c,t,n)}async function Y(e,t,r,n,a){let o=n?await (0,J.Zx)(n,r):null,i=await X(o?{chain:o.chain,client:e.client,walletConnect:{pairingTopic:o.pairingTopic,optionalChains:o.optionalChains}}:{client:e.client,walletConnect:{}},r,a,!0),s=i.accounts[0];if(!s)throw Error("No accounts found on provider.");let c=(0,U.J)(i.chainId);return Q(s,e.chain&&e.chain.id===c?e.chain:(0,x.XY)(c),i,t,n)}async function X(e,t,n){var a,o,i,s,c;let l=arguments.length>3&&void 0!==arguments[3]&&arguments[3],d=await (0,q.d)(t),u=e.walletConnect,{EthereumProvider:b,OPTIONAL_EVENTS:h,OPTIONAL_METHODS:p}=await Promise.all([r.e(16764),r.e(62663),r.e(46360)]).then(r.bind(r,11455)),{rpcMap:v,chainsToRequest:f}=W({client:e.client,chain:e.chain,optionalChains:null===(a=e.walletConnect)||void 0===a?void 0:a.optionalChains}),m=await b.init({showQrModal:(null==u?void 0:u.showQrModal)===void 0?!n:u.showQrModal,projectId:(null==u?void 0:u.projectId)||L.O,optionalMethods:p,optionalEvents:h,optionalChains:f,chains:e.chain?[e.chain.id]:f.length>0?[f[0]]:[1],metadata:{name:(null==u?void 0:null===(o=u.appMetadata)||void 0===o?void 0:o.name)||(0,T.f)().name,description:(null==u?void 0:null===(i=u.appMetadata)||void 0===i?void 0:i.description)||(0,T.f)().description,url:(null==u?void 0:null===(s=u.appMetadata)||void 0===s?void 0:s.url)||(0,T.f)().url,icons:[(null==u?void 0:null===(c=u.appMetadata)||void 0===c?void 0:c.logoUrl)||(0,T.f)().logoUrl]},rpcMap:v,qrModalOptions:null==u?void 0:u.qrModalOptions,disableProviderPing:!0});if(m.events.setMaxListeners(Number.POSITIVE_INFINITY),!l&&m.session&&await m.disconnect(),"walletConnect"!==t){function g(){var e,t,r,a;let o=(null===(a=m.session)||void 0===a?void 0:null===(r=a.peer)||void 0===r?void 0:null===(t=r.metadata)||void 0===t?void 0:null===(e=t.redirect)||void 0===e?void 0:e.native)||d.mobile.native||d.mobile.universal;n&&o&&n(o)}m.signer.client.on("session_request_sent",g),m.events.addListener("disconnect",()=>{m.signer.client.off("session_request_sent",g)})}return m}function F(e,t){return{address:t,async sendTransaction(t){return{transactionHash:await e.request({method:"eth_sendTransaction",params:[{gas:t.gas?(0,I.eC)(t.gas):void 0,value:t.value?(0,I.eC)(t.value):void 0,from:this.address,to:t.to,data:t.data}]})}},async signMessage(t){let{message:r}=t,n="string"==typeof r?(0,I.$G)(r):r.raw instanceof Uint8Array?(0,I.dg)(r.raw):r.raw;return e.request({method:"personal_sign",params:[n,this.address]})},async signTypedData(t){let r=(0,S.t)(t),{domain:a,message:o,primaryType:i}=r,s={EIP712Domain:(0,n.cj)({domain:a}),...r.types};(0,n.iC)({domain:a,message:o,primaryType:i,types:s});let c=(0,n.H6)({domain:null!=a?a:{},message:o,primaryType:i,types:s});return await e.request({method:"eth_signTypedData_v4",params:[this.address,c]})}}}function Q(e,t,r,n,a){let o=F(r,e);async function i(){r.removeListener("accountsChanged",c),r.removeListener("chainChanged",l),r.removeListener("disconnect",s),await r.disconnect()}function s(){z([],a),null==a||a.removeItem(A.lastUsedChainId),i(),n.emit("disconnect",void 0)}function c(e){if(e[0]){let t=F(r,(0,_.Kn)(e[0]));n.emit("accountChanged",t),n.emit("accountsChanged",e)}else s()}function l(e){let t=(0,x.XY)((0,U.J)(e));n.emit("chainChanged",t),null==a||a.setItem(A.lastUsedChainId,String(e))}return r.on("accountsChanged",c),r.on("chainChanged",l),r.on("disconnect",s),r.on("session_delete",s),[o,t,i,e=>V(r,e,a)]}async function V(e,t,r){let n=t.id;try{var a,o,i,s;let c=function(e){var t,r,n;let a=null===(n=e.session)||void 0===n?void 0:null===(r=n.namespaces[L.A])||void 0===r?void 0:null===(t=r.chains)||void 0===t?void 0:t.map(e=>Number.parseInt(e.split(":")[1]||""));return null!=a?a:[]}(e),l=(null===(o=e.session)||void 0===o?void 0:null===(a=o.namespaces[L.A])||void 0===a?void 0:a.methods)||[];if(!c.includes(n)&&l.includes(k)){let a=await (0,x.ZN)(t),o=[...new Set([...(null===(i=t.blockExplorers)||void 0===i?void 0:i.map(e=>e.url))||[],...(null===(s=a.explorers)||void 0===s?void 0:s.map(e=>e.url))||[]])];await e.request({method:k,params:[{chainId:(0,I.eC)(a.chainId),chainName:a.name,nativeCurrency:a.nativeCurrency,rpcUrls:(0,N.w)(a),blockExplorerUrls:o.length>0?o:void 0}]});let c=await H(r);c.push(n),z(c,r)}await e.request({method:"wallet_switchEthereumChain",params:[{chainId:(0,I.eC)(n)}]})}catch(t){let e="string"==typeof t?t:null==t?void 0:t.message;if(/user rejected request/i.test(e))throw new C(t);throw new R(t)}}function z(e,t){null==t||t.setItem(A.requestedChains,JSON.stringify(e))}async function H(e){let t=await e.getItem(A.requestedChains);return t?JSON.parse(t):[]}function W(e){let t={};e.chain&&(t[e.chain.id]=(0,x.GO)({chain:e.chain,client:e.client}));let r=((null==e?void 0:e.optionalChains)||[]).slice(0,10);for(let n of r)t[n.id]=(0,x.GO)({chain:n,client:e.client});let n=r.map(e=>e.id)||[],a=e.chain?[e.chain.id,...n]:n.length>0?n:[1];return e.chain||0!==r.length||(t[1]=(0,x.XY)(1).rpc),{rpcMap:t,chainsToRequest:a}}}}]);